dataset:
  type: ImageNetDataset
  parameters:
    dataset_root: ./build/ImageNetDataset
    image_memory_layout: NCHW
    preprocess_type: torch
    inference_batch_size: 1
model_wrapper:
  type: TinygradImageNet
  parameters:
    model_path: model50.safetensors
    model_file: https://raw.githubusercontent.com/tinygrad/tinygrad/bcc7623025d39f4994eab0394beb83662d879ec8/extra/models/resnet.py
    model_cls: ResNet50
    input_shape: [1, 3, 224, 224]
    num_classes: 1000
optimizers:
- type: TinygradOptimizer
  parameters:
    compiled_model_path: ./build/compiled_model.tar
runtime:
  type: TinygradRuntime
  parameters:
    beam_count: 2
    jit_optimize: true
    save_model_path: ./build/compiled_model.tar
